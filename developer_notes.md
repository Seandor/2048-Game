# 开发手记

2016-07-05
__项目重启__:

- [x] 1. 增加计分及游戏结束判断条件，仅逻辑层面，控制台显示。
- [x] 2. 让分数和游戏的开始结束在页面上正确显示。
- [x] 3. 让字体大小随着数字位数的增大而减小，就像font-responsive.
- [ ] 4. 增加动画。
- [ ] 5. 增加触屏支持。

### Notes

 - [X] 增加icon
 - [X] 使用canvas画游戏面板
 - [X] null + null === 0
 - [ ] 必须要理解callback函数的原理
 - [x] 使用Object存储键值的方式能做到和使用`which` 或 `if else`语句一样的效果，但是避免了语句的重复。
 - [x] callback函数就像是自己写一个函数写了一半，后面不写了，交给另外一个函数取执行，有点像放出一个编程接口。
 - [x] canvas重绘应该需要清除原有的格子内容，否则原有的格子边缘看起来很脏。
 - [x] 圆角矩形的边角不那么圆润导致填充颜色看起来有点模糊，需修改。这个很难解决，暂时就不修改了，影响不是很大。
 - [x] canvas的文本看起来也比较模糊，这个应该是可以解决的。
 - [ ] 当前最重要的任务是完成2，3两个功能，动画部分和触屏支持都是可选的，是后期优化的部分，虽然很有趣，但现在时间并不是很充裕。

### 为什么要做这个项目
做这个小项目主要有两个目的，一是能够更多地使用原生javascript，二是能学习更多的编程技巧。

### 关于高DPI
这跟放大图片是一个道理。你放大图片后，图片占的面积上有更多的像素点了，但是图片本身的像素不变，所以中间很多像素点都是空的，所以图片变模糊了。当你把一个图片放在高分屏上，同样，如果图片没有缩小显示，那么图片所在的面积上像素点就会变多，而图片本身没有足够多的像素去填充，所以图片也变模糊了。

### 关于callback函数
callback函数有一个小坑，那就是你不能在callback函数里面返回值。因为你返回的值会跑到把callback函数作为参数的母函数里面，无法正常获取，母函数也不会退出。比如`grid.eachCell()`函数的正确用法是当需要完整遍历grid的时候才去使用，如果只是检查grid有没有空的cell，是不能用该方法的。

### 关于动画
目前我用requestAnimationFramework可以做出Tile收缩和膨胀这两种简单的动画效果，分别用在刚生成的Tile和刚刚merge的Tile上，应该还需要加一个被merge的Tile消失的动画。现在难的地方在于，我如何将动画嵌入至整个程序中，估计不破坏程序原有的结构是不可能的。
